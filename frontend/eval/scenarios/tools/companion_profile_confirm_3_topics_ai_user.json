{
  "dataset_key": "state_machines",
  "id": "companion_profile_confirm_3_topics_ai_user",
  "description": "User Profile Confirmation (Companion): simulate-user first states 3 preferences (list), defers confirmation, then later confirms them one by one. Verifies Sophia can keep the 3 topics and reconfirm later.",
  "tags": ["sophia.companion", "state_machine", "user_profile_confirmation"],
  "setup": {
    "keep_test_user": true
  },
  "persona": {
    "label": "Utilisateur web",
    "age_range": "25-40",
    "style": "oral, naturel, pas trop long",
    "background": "Je veux que Sophia adapte son style: direct, réponses courtes, et qu'elle évite de me ramener au plan. Je veux d'abord poser la liste, puis confirmer plus tard."
  },
  "objectives": [
    {
      "kind": "profile_confirm_3_topics_realistic",
      "spec": {
        "tone": "direct",
        "verbosity": "short",
        "use_emojis": "never"
      }
    }
  ],
  "assertions": {
    "must_include_agent": ["companion"],
    "assistant_must_not_match": ["\\*\\*"]
  },
  "mechanical_assertions": {
    "chat_state_temp_memory_equals": {
      "profile_confirmation_state": null
    },
    "user_profile_facts_must_include": [
      { "key": "conversation.tone", "value": "direct" },
      { "key": "conversation.verbosity", "value": "short" },
      { "key": "conversation.use_emojis", "value": "never" }
    ]
  }
}


